#!/bin/bash

# Base directory where catchment folders live
BASE_DIR="$HOME/ngiab_preprocess_output"

# List of catchment IDs to run
# cat_ids=(
# '1010263' '1021677' '1023764' '102612' '103066' '105032' '105049' '105101'
# '105663' '105836' '1077437' '1077455' '1077921' '1078797' '1078883' '1078884' '1078889'
# '1078901' '1078916' '1079044' '1079156' '1079314' '1079621' '1080803' '1081184' '1081895'
# '1088778' '1090024' '1091210' '1092307' '1092590' '1093260' '1093967' '1094076' '1094439'
# '1097193' '109748' '1098522' '1098532' '1100007' '1100010' '1100111' '1100508' '1100659'
# '1100668' '1100834' '1103277' '1106175' '1106551' '1111774' '1111984' '1121208' '1121664'
# '1122758' '1123000' '1123314' '1123351' '1123606' '1123628' '1125753' '114960' '115994'
# '116003' '116210' '116485' '116510' '116555' '116556' '116705' '117089' '119180' '121130'
# '1315131' '1324300' '1324836' '1328476' '1334564' '1338147' '1338908' '1339142' '1339618'
# '1539825' '1540398' '1550076' '1555666' '1559541' '1561642' '1562395' '1564208' '1570551'
# '1580153' '1582822' '1585863' '1590404' '17457' '17490' '1873568' '2148498' '2149779'
# '2149905' '2163782' '2171432' '2172259' '2179964' '2179983' '2179985' '2179991' '2180666'
# '2180770' '2185390' '2186888' '2188294' '2189046' '2189444' '2189733' '2190019' '2198828'
# '2199507' '2407979' '2407990' '2408311' '2411262' '2412684' '2415300' '2419044' '2419963'
# '2434636' '2438150' '2439150' '2439459' '2441034' '2441171' '2441965' '247118' '247359'
# '247372' '247955' '249028' '251946' '2526982' '256379' '257900' '258209' '258217' '259429'
# '262861' '263739' '265724' '267179' '270662' '270916' '271006' '271398' '2716276' '2720627'
# '2748412' '2751904' '2877827' '3052009' '3056235' '420580' '420586' '420618' '482252'
# '482303' '487858' '491530' '491544' '491560' '491602' '502014' '505420' '505611' '506174'
# '506332' '506560' '655183' '658797' '659075' '661279' '787253' '788423' '788433' '789787'
# '789788' '791355' '791519' '792075' '792341' '794072' '794236' '795702' '796025' '798139'
# '804994' '805079' '805158' '805223' '805795' '805799' '805806' '807627' '807656' '807661'
# '809769' '811597' '811610' '811620' '811621' '813331' '813388' '813434' '813886' '813937'
# '814543' '814754' '814794' '817013' '821251' '822473' '823812' '825925' '826305' '826367'
# '826868' '827255' '827260' '829282' '830761' '831306' '831331' '832646' '832650' '832651'
# '832677' '836391' '836437' '837083' '91390' '91769' '91771' '92138' '93002' '93071'
# '94417' '94429' '94440' '94536' '94772' '95082' '95097' '95120' '96522' '99536' '100224'
# )

cat_ids=(
  "105049" "2877827" "271006" "116705" "117089" "805158" "811597" "811610" "811621" "805795"
  "105836" "105101" "105663" "105836" "1010263" "116003" "794236" "791355" "1559541" "251946"
  "832646" "791355" "792075" "805079" "2716276" "2720627" "1338908" "655183" "119180" "105049"
  "2526982" "826868" "1079044" "2189444" "2190019" "826367" "805079" "805079" "1324836"
  "1324836" "2163782" "2189046" "2439459" "491530" "491560" "491602" "831306" "836391"
  "482252" "1021677" "814543" "1125753" "3056235"
)


# Loop through catchment IDs
for id in "${cat_ids[@]}"; do
    FOLDER="cat-$id"
    FOLDER_PATH="$BASE_DIR/$FOLDER"

    echo "â–¶ Entering $FOLDER..."

    # Check if folder exists
    if [ ! -d "$FOLDER_PATH" ]; then
        echo "Folder does not exist: $FOLDER_PATH"
        continue
    fi

    # Change to directory
    cd "$FOLDER_PATH" || { echo "Failed to cd into $FOLDER_PATH"; continue; }

    # Run ngen
    ngen "./config/cat-${id}_subset.gpkg" "" "./config/cat-${id}_subset.gpkg" "" "./config/realization.json"

    echo "Finished running ngen for $FOLDER"
done

echo "All catchments processed!"
